=== RUN   TestBasicCircuitLifecycle
--- PASS: TestBasicCircuitLifecycle (0.00s)
=== RUN   TestGenerateKeyPair
--- PASS: TestGenerateKeyPair (0.00s)
=== RUN   TestDeriveSharedKey
--- PASS: TestDeriveSharedKey (0.00s)
=== RUN   TestEncryptDecryptPayload
=== RUN   TestEncryptDecryptPayload/Empty_message
=== RUN   TestEncryptDecryptPayload/Short_message
=== RUN   TestEncryptDecryptPayload/Long_message
=== RUN   TestEncryptDecryptPayload/Corrupted_ciphertext
--- PASS: TestEncryptDecryptPayload (0.00s)
    --- PASS: TestEncryptDecryptPayload/Empty_message (0.00s)
    --- PASS: TestEncryptDecryptPayload/Short_message (0.00s)
    --- PASS: TestEncryptDecryptPayload/Long_message (0.00s)
    --- PASS: TestEncryptDecryptPayload/Corrupted_ciphertext (0.00s)
=== RUN   TestCreateOnionLayers
--- PASS: TestCreateOnionLayers (0.00s)
=== RUN   TestAESGCMStandardCompatibility
--- PASS: TestAESGCMStandardCompatibility (0.00s)
=== RUN   TestOnionNetworkTraversalFixed
    onion_network_test.go:81: Relay 1 processing packet
    onion_network_test.go:97: Relay 2 processing packet
    onion_network_test.go:112: Relay 3 processing packet
--- PASS: TestOnionNetworkTraversalFixed (0.00s)
=== RUN   TestOnionPacketCreationAndRouting
    packet_routing_test.go:62: Relay 1 processing packet
    packet_routing_test.go:62: Relay 2 processing packet
    packet_routing_test.go:62: Relay 3 processing packet
--- PASS: TestOnionPacketCreationAndRouting (0.00s)
=== RUN   TestHopInfoEncoding
--- PASS: TestHopInfoEncoding (0.00s)
=== RUN   TestOnionPacketEncoding
--- PASS: TestOnionPacketEncoding (0.00s)
=== RUN   TestOnionNetworkTraversal
--- PASS: TestOnionNetworkTraversal (0.00s)
=== RUN   TestHopInfoSerialization
--- PASS: TestHopInfoSerialization (0.00s)
=== RUN   TestOnionPacketSerialization
--- PASS: TestOnionPacketSerialization (0.00s)
=== RUN   TestInnerPayloadSerialization
=== RUN   TestInnerPayloadSerialization/Publish_Document
=== RUN   TestInnerPayloadSerialization/Request_Block
=== RUN   TestInnerPayloadSerialization/Response
=== RUN   TestInnerPayloadSerialization/Empty_data
=== RUN   TestInnerPayloadSerialization/Binary_data
--- PASS: TestInnerPayloadSerialization (0.00s)
    --- PASS: TestInnerPayloadSerialization/Publish_Document (0.00s)
    --- PASS: TestInnerPayloadSerialization/Request_Block (0.00s)
    --- PASS: TestInnerPayloadSerialization/Response (0.00s)
    --- PASS: TestInnerPayloadSerialization/Empty_data (0.00s)
    --- PASS: TestInnerPayloadSerialization/Binary_data (0.00s)
=== RUN   TestSerializationCornerCases
=== RUN   TestSerializationCornerCases/Invalid_encoded_data
=== RUN   TestSerializationCornerCases/Empty_data
--- PASS: TestSerializationCornerCases (0.00s)
    --- PASS: TestSerializationCornerCases/Invalid_encoded_data (0.00s)
    --- PASS: TestSerializationCornerCases/Empty_data (0.00s)
=== RUN   TestProtocolConstantConsistency
--- PASS: TestProtocolConstantConsistency (0.00s)
=== RUN   TestProtocolConstants
--- PASS: TestProtocolConstants (0.00s)
=== RUN   TestCircuitStatusConstants
--- PASS: TestCircuitStatusConstants (0.00s)
=== RUN   TestMessageTypeConstants
--- PASS: TestMessageTypeConstants (0.00s)
=== RUN   TestCircuitSetupMessage
--- PASS: TestCircuitSetupMessage (0.00s)
=== RUN   TestCircuitTeardownMessage
--- PASS: TestCircuitTeardownMessage (0.00s)
=== RUN   TestCircuitSetupResponse
--- PASS: TestCircuitSetupResponse (0.00s)
=== RUN   TestCircuitCreationAndLookup
--- PASS: TestCircuitCreationAndLookup (0.00s)
=== RUN   TestCircuitTeardown
--- PASS: TestCircuitTeardown (0.00s)
=== RUN   TestStaleCircuitCleanup
fatal error: sync: Unlock of unlocked RWMutex

goroutine 62 [running]:
sync.fatal({0x82f19c?, 0x2b09f29760bfd4e7?})
	/usr/local/go/src/runtime/panic.go:1038 +0x18
sync.(*RWMutex).Unlock(0xc000206800)
	/usr/local/go/src/sync/rwmutex.go:212 +0x45
github.com/sohelahmedjony/decentralize-wikileaks/internal/onion.TestStaleCircuitCleanup(0xc000215340)
	/home/jony/Project/decentralize-wikileaks/internal/onion/relay_management_test.go:165 +0x49b
testing.tRunner(0xc000215340, 0x8ee280)
	/usr/local/go/src/testing/testing.go:1792 +0xf4
created by testing.(*T).Run in goroutine 1
	/usr/local/go/src/testing/testing.go:1851 +0x413

goroutine 1 [chan receive]:
testing.(*T).Run(0xc00008ae00, {0x82a0e5?, 0xc0000fbb30?}, 0x8ee280)
	/usr/local/go/src/testing/testing.go:1859 +0x431
testing.runTests.func1(0xc00008ae00)
	/usr/local/go/src/testing/testing.go:2279 +0x37
testing.tRunner(0xc00008ae00, 0xc0000fbc70)
	/usr/local/go/src/testing/testing.go:1792 +0xf4
testing.runTests(0xc0000f2bb8, {0xbf5300, 0x1b, 0x1b}, {0xbfe340?, 0x7?, 0xbfcca0?})
	/usr/local/go/src/testing/testing.go:2277 +0x4b4
testing.(*M).Run(0xc000156820)
	/usr/local/go/src/testing/testing.go:2142 +0x64a
main.main()
	_testmain.go:97 +0x9b
FAIL	github.com/sohelahmedjony/decentralize-wikileaks/internal/onion	0.031s
FAIL
